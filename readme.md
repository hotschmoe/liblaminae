# lib/ - Laminae User-Space Library

User programs import via `@import("liblaminae")`. Entry point is `root.zig`.

## Directory Structure

### man/ - Hand-Written Modules
High-level APIs built on top of syscalls and shared code. Edit freely.

- `console.zig` - Zero-syscall console output (ring buffer)
- `heap.zig` - Dynamic memory allocation via sys_brk
- `virtio.zig` - VirtIO queue management for drivers
- `net_api.zig` - Network stack client API
- `platform.zig` - Platform service IPC wrappers
- `tasks.zig` - Cooperative task scheduling

### gen/ - Generated Code
Auto-generated by `zig build gen-lib`. **Do not edit manually.**

- `syscalls.zig` - Inline syscall wrappers (from kernel table)
- `errors.zig` - Error constants and utilities

Source of truth: `src/kernel/syscalls/table.zig`

### shared/ - Synced from Kernel
Auto-copied from `src/shared/` by `zig build gen-lib`. **Do not edit manually.**

- `va_layout.zig` - Virtual address layout constants
- `platform_types.zig` - Platform identification enum
- `arch/` - EL0-safe barriers, idle, container_info
- `compat/table.zig` - Device-to-driver compatibility table
- `platform/table.zig` - Platform container lookup table
- `icc/` - Inter-container communication schemas

Source of truth: `src/shared/`

## Regenerating

```bash
zig build gen-lib
```

This syncs `src/shared/` -> `lib/shared/` (glob-based, auto-discovers files)
and generates `lib/gen/` from kernel tables.